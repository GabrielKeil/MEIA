<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Grupo">
<meta name="dcterms.date" content="2025-12-11">

<title>PCA and Outlier Analysis on Machines Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="report_files/libs/clipboard/clipboard.min.js"></script>
<script src="report_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="report_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="report_files/libs/quarto-html/popper.min.js"></script>
<script src="report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="report_files/libs/quarto-html/anchor.min.js"></script>
<link href="report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="report_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="report_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="report_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="report_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#objectives-of-the-study" id="toc-objectives-of-the-study" class="nav-link" data-scroll-target="#objectives-of-the-study"><span class="header-section-number">1.1</span> Objectives of the study</a></li>
  </ul></li>
  <li><a href="#study-plan-at-a-glance" id="toc-study-plan-at-a-glance" class="nav-link" data-scroll-target="#study-plan-at-a-glance"><span class="header-section-number">2</span> Study plan (at a glance)</a></li>
  <li><a href="#setup-and-data" id="toc-setup-and-data" class="nav-link" data-scroll-target="#setup-and-data"><span class="header-section-number">3</span> Setup and data</a></li>
  <li><a href="#data-description" id="toc-data-description" class="nav-link" data-scroll-target="#data-description"><span class="header-section-number">4</span> Data description</a></li>
  <li><a href="#exploratory-summaries" id="toc-exploratory-summaries" class="nav-link" data-scroll-target="#exploratory-summaries"><span class="header-section-number">5</span> Exploratory summaries</a>
  <ul class="collapse">
  <li><a href="#classical-vs-robust-locationscale" id="toc-classical-vs-robust-locationscale" class="nav-link" data-scroll-target="#classical-vs-robust-locationscale"><span class="header-section-number">5.1</span> Classical vs robust location/scale</a></li>
  <li><a href="#covariance-total-and-generalized-variance" id="toc-covariance-total-and-generalized-variance" class="nav-link" data-scroll-target="#covariance-total-and-generalized-variance"><span class="header-section-number">5.2</span> Covariance, total and generalized variance</a></li>
  <li><a href="#mahalanobis-distances-classical-vs-robust" id="toc-mahalanobis-distances-classical-vs-robust" class="nav-link" data-scroll-target="#mahalanobis-distances-classical-vs-robust"><span class="header-section-number">5.3</span> Mahalanobis distances (classical vs robust)</a></li>
  <li><a href="#summary-of-the-preliminary-analysis" id="toc-summary-of-the-preliminary-analysis" class="nav-link" data-scroll-target="#summary-of-the-preliminary-analysis"><span class="header-section-number">5.4</span> Summary of the preliminary analysis</a></li>
  </ul></li>
  <li><a href="#principal-component-analysis-original-vs-standardized" id="toc-principal-component-analysis-original-vs-standardized" class="nav-link" data-scroll-target="#principal-component-analysis-original-vs-standardized"><span class="header-section-number">6</span> Principal Component Analysis (original vs standardized)</a>
  <ul class="collapse">
  <li><a href="#scree-plots-and-variance-explained" id="toc-scree-plots-and-variance-explained" class="nav-link" data-scroll-target="#scree-plots-and-variance-explained"><span class="header-section-number">6.1</span> Scree plots and variance explained</a></li>
  <li><a href="#loadings-and-interpretation-aids" id="toc-loadings-and-interpretation-aids" class="nav-link" data-scroll-target="#loadings-and-interpretation-aids"><span class="header-section-number">6.2</span> Loadings and interpretation aids</a></li>
  <li><a href="#scores-plot-first-two-pcs" id="toc-scores-plot-first-two-pcs" class="nav-link" data-scroll-target="#scores-plot-first-two-pcs"><span class="header-section-number">6.3</span> Scores plot (first two PCs)</a></li>
  </ul></li>
  <li><a href="#outlier-experiment" id="toc-outlier-experiment" class="nav-link" data-scroll-target="#outlier-experiment"><span class="header-section-number">7</span> Outlier experiment</a>
  <ul class="collapse">
  <li><a href="#visual-comparison-scores" id="toc-visual-comparison-scores" class="nav-link" data-scroll-target="#visual-comparison-scores"><span class="header-section-number">7.1</span> Visual comparison: scores</a>
  <ul class="collapse">
  <li><a href="#distance-diagnostics-robust-pca" id="toc-distance-diagnostics-robust-pca" class="nav-link" data-scroll-target="#distance-diagnostics-robust-pca"><span class="header-section-number">7.1.1</span> Distance diagnostics (robust PCA)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#decisions" id="toc-decisions" class="nav-link" data-scroll-target="#decisions"><span class="header-section-number">8</span> Decisions</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">9</span> Conclusions</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography"><span class="header-section-number">10</span> Bibliography</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="../../../Programação/estatistica/projecto-1/report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PCA and Outlier Analysis on Machines Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Grupo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 11, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This report walks through an analysis of a subset of the <code>machines</code> data from the <code>rrcov</code> package (rows <strong>hp-3000/64</strong> to <strong>ibm-4331-2</strong>).</p>
<section id="objectives-of-the-study" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="objectives-of-the-study"><span class="header-section-number">1.1</span> Objectives of the study</h2>
<ul>
<li>Describe the variables using classical and robust summaries, Mahalanobis distances and graphical tools, and comment on the main patterns in the data.</li>
<li>Apply PCA on the original and standardized scales, compare the proportion of explained variance and interpret the retained components (keeping at least 95% of total variance).</li>
<li>Introduce a single atypical observation and compare the impact on classical PCA versus a robust PCA based on the MCD estimate.</li>
</ul>
</section>
</section>
<section id="study-plan-at-a-glance" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Study plan (at a glance)</h1>
<ol type="1">
<li>Inspect the data: structure, variable meaning, rough scales.<br>
</li>
<li>Classical and robust summaries to see skew/tails and dependence (covariance, distances).<br>
</li>
<li>PCA on raw vs standardized variables; compare variance explained and loadings; pick components reaching 95%.<br>
</li>
<li>Inject one outlier and compare classical vs robust PCA to illustrate sensitivity.<br>
</li>
<li>Conclude and state a recommendation for which PCA to report and why.</li>
</ol>
</section>
<section id="setup-and-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Setup and data</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c("rrcov", "robustbase"), repos = "https://cloud.r-project.org")  # install if missing</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rrcov)          <span class="co"># robust multivariate methods (PCA, covariance)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robustbase)     <span class="co"># robust basics (MCD, etc.)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(machines)          <span class="co"># load the machines dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>machines_sub <span class="ot">&lt;-</span> machines[<span class="dv">71</span><span class="sc">:</span><span class="dv">111</span>, ]                  <span class="co"># slice rows hp-3000/64 ... ibm-4331-2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>machines_sub<span class="sc">$</span>machine <span class="ot">&lt;-</span> <span class="fu">rownames</span>(machines_sub)      <span class="co"># store machine names for labeling</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(machines_sub) <span class="ot">&lt;-</span> <span class="cn">NULL</span>                      <span class="co"># drop row names to avoid confusion</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(machines_sub)                         <span class="co"># count observations</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>n_vars <span class="ot">&lt;-</span> <span class="fu">ncol</span>(machines_sub) <span class="sc">-</span> <span class="dv">1</span>                    <span class="co"># count numeric variables (exclude machine names)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(machines_sub, <span class="dv">3</span>)                               <span class="co"># peek at the first rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["MYCT"],"name":[1],"type":["int"],"align":["right"]},{"label":["MMIN"],"name":[2],"type":["int"],"align":["right"]},{"label":["MMAX"],"name":[3],"type":["int"],"align":["right"]},{"label":["CACH"],"name":[4],"type":["int"],"align":["right"]},{"label":["CHMIN"],"name":[5],"type":["int"],"align":["right"]},{"label":["CHMAX"],"name":[6],"type":["int"],"align":["right"]},{"label":["PRP"],"name":[7],"type":["int"],"align":["right"]},{"label":["ERP"],"name":[8],"type":["int"],"align":["right"]},{"label":["machine"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"75","2":"2000","3":"8000","4":"8","5":"3","6":"24","7":"62","8":"47","9":"hp-3000/64","_rn_":"1"},{"1":"75","2":"3000","3":"8000","4":"8","5":"3","6":"48","7":"64","8":"54","9":"hp-3000/88","_rn_":"2"},{"1":"175","2":"256","3":"2000","4":"0","5":"3","6":"24","7":"22","8":"20","9":"hp-3000/iii","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize each variable (min/mean/median/max/quartiles)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(machines_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-description" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data description</h1>
<ul>
<li>Observations: 41 machines; numeric variables: 8.</li>
<li>Variables (all numeric):
<ul>
<li><code>MYCT</code> cycle time (ns), <code>MMIN</code> min memory (KB), <code>MMAX</code> max memory (KB), <code>CACH</code> cache (KB),<br>
</li>
<li><code>CHMIN</code> min channels, <code>CHMAX</code> max channels, <code>PRP</code> published perf, <code>ERP</code> estimated perf.<br>
</li>
</ul></li>
<li>Machine IDs live in <code>machine</code> (formerly row names). Use them for labels, not for analysis.</li>
</ul>
<p>Historically, these data come from the Computer Hardware dataset describing mainframe computers from the 1970s–1980s. Each row corresponds to a specific machine model, with hardware specifications (cycle time, memory, cache, number of I/O channels) and two performance measures. The variables <code>CHMIN</code> and <code>CHMAX</code> denote the minimum and maximum number of I/O channels the system can be configured with, so they reflect scalability for small versus large installations.</p>
<p>To make the variables more concrete, consider two machines in our subset:</p>
<ul>
<li><code>hp-3000/iii</code> has <code>MYCT = 175</code> ns (slower CPU), <code>MMIN = 256</code> KB and <code>MMAX = 2000</code> KB of memory, no cache and between 3 and 24 channels (<code>CHMIN = 3</code>, <code>CHMAX = 24</code>), with published performance <code>PRP = 22</code>. This is a relatively modest system in both memory and performance.</li>
<li><code>ibm-3081</code> has <code>MYCT = 26</code> ns (much faster), <code>MMIN = 16000</code> KB and <code>MMAX = 32000</code> KB of memory, cache <code>CACH = 64</code>, between 16 and 24 channels, and <code>PRP = 465</code>. It represents a high-end configuration with far greater memory and throughput capability.</li>
</ul>
<p>These contrasts illustrate how larger memory, more channels and lower cycle time are associated with higher performance measures, which is precisely the multivariate relationship we summarise with PCA in later sections.</p>
<p>Before any formal analysis, these hardware considerations give us clear prior expectations: we anticipate a strong negative association between <code>MYCT</code> and the performance variables, and positive associations between <code>MMIN</code>, <code>MMAX</code>, <code>CACH</code>, the channel counts and <code>PRP</code>/<code>ERP</code>. We also expect <code>PRP</code> and <code>ERP</code> to be highly correlated, since both are measuring the same underlying notion of computing power. In terms of PCA, a natural prior is that the leading standardized component will reflect an overall “size/performance” level combining memory, cache and performance, while a secondary component may capture differences in channel configuration relative to speed.</p>
<p>Quick look at the machine names:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(machines_sub<span class="sc">$</span>machine, <span class="dv">5</span>)                       <span class="co"># show first few machine IDs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "hp-3000/64"  "hp-3000/88"  "hp-3000/iii" "harris-100"  "harris-300" </code></pre>
</div>
</div>
<p>Helper functions for trimmed/winsorized means and total/generalized variance:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>winsor_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)) {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs, <span class="at">names =</span> <span class="cn">FALSE</span>)           <span class="co"># lower/upper cutoffs</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">pmin</span>(<span class="fu">pmax</span>(x, qs[<span class="dv">1</span>]), qs[<span class="dv">2</span>]))                 <span class="co"># clamp extremes then average</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>total_variance <span class="ot">&lt;-</span> <span class="cf">function</span>(S) <span class="fu">sum</span>(<span class="fu">diag</span>(S))          <span class="co"># sum of variances (trace)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>generalized_variance <span class="ot">&lt;-</span> <span class="cf">function</span>(S) <span class="fu">determinant</span>(S, <span class="at">logarithm =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>modulus  <span class="co"># log-determinant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exploratory-summaries" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Exploratory summaries</h1>
<section id="classical-vs-robust-locationscale" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="classical-vs-robust-locationscale"><span class="header-section-number">5.1</span> Classical vs robust location/scale</h2>
<p>Focus: see how skew and heavy tails affect means; compare to median/trimmed/winsor/MAD.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> machines_sub[ , <span class="fu">setdiff</span>(<span class="fu">names</span>(machines_sub), <span class="st">"machine"</span>)]  <span class="co"># numeric-only data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>stat_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(                              <span class="co"># assemble summary table</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">names</span>(num_vars),                     <span class="co"># variable name</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">sapply</span>(num_vars, mean),                  <span class="co"># arithmetic mean</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">sapply</span>(num_vars, median),              <span class="co"># median</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trimmed_mean =</span> <span class="fu">sapply</span>(num_vars, mean, <span class="at">trim =</span> <span class="fl">0.1</span>),  <span class="co"># 10% trimmed mean</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">winsor_mean =</span> <span class="fu">sapply</span>(num_vars, winsor_mean),    <span class="co"># 5–95 winsorized mean</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fu">sapply</span>(num_vars, sd),                      <span class="co"># standard deviation</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="fu">sapply</span>(num_vars, var),                    <span class="co"># variance</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mad =</span> <span class="fu">sapply</span>(num_vars, mad)                     <span class="co"># median absolute deviation</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>stat_table                                        <span class="co"># show table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Looking at the numbers, the strongest asymmetry appears in the memory and performance variables: for <code>MMIN</code>, <code>MMAX</code>, <code>PRP</code> and <code>ERP</code> the mean is roughly two to three times the median, and the 10% trimmed mean sits well below the raw mean. This points to heavy right tails driven by a few very powerful machines. <code>CHMIN</code> is also highly concentrated at small values (median 1 and MAD 0), with only a minority of models offering substantially more minimum channels. <code>MYCT</code>, <code>CACH</code> and <code>CHMAX</code> show milder but still noticeable right skew, with the mean above the median and the trimmed mean in between. Overall, the table suggests a market dominated by modest systems plus a smaller group of high-end configurations that pull the means upward.</p>
</section>
<section id="covariance-total-and-generalized-variance" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="covariance-total-and-generalized-variance"><span class="header-section-number">5.2</span> Covariance, total and generalized variance</h2>
<p>These give a sense of joint spread; generalized variance is the log-determinant (stable on the log scale).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>S_classic <span class="ot">&lt;-</span> <span class="fu">cov</span>(num_vars)                          <span class="co"># classical covariance matrix</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>total_var <span class="ot">&lt;-</span> <span class="fu">total_variance</span>(S_classic)              <span class="co"># total variance (trace)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>gen_var_log <span class="ot">&lt;-</span> <span class="fu">generalized_variance</span>(S_classic)      <span class="co"># log generalized variance</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariance_matrix =</span> S_classic,                  <span class="co"># covariance matrix</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_variance =</span> total_var,                     <span class="co"># total variance</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">generalized_variance_log =</span> gen_var_log          <span class="co"># log generalized variance</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>)                                                  <span class="co"># print results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>At the marginal level the largest variances correspond to <code>MMAX</code>, <code>MMIN</code>, <code>PRP</code> and <code>ERP</code>, confirming that memory size and performance measures are the main sources of spread in the data; <code>MYCT</code> (cycle time) also varies substantially, whereas <code>CHMIN</code> and <code>CACH</code> are comparatively more concentrated. The covariance terms are strongly positive between memory and performance variables and negative between <code>MYCT</code> and the same quantities, reflecting that faster machines tend to be those with larger memory and higher performance ratings. The total variance is therefore dominated by a common “size/performance” factor, and the generalized variance indicates that the data cloud is elongated mainly along that direction rather than being equally spread in all dimensions.</p>
</section>
<section id="mahalanobis-distances-classical-vs-robust" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="mahalanobis-distances-classical-vs-robust"><span class="header-section-number">5.3</span> Mahalanobis distances (classical vs robust)</h2>
<p>We use Mahalanobis distances to flag candidate multivariate outliers. The classical version relies on the sample mean and covariance matrix, so both the estimated centre and the shape of the ellipsoid can be strongly influenced by extreme observations. The robust version replaces these by the MCD (Minimum Covariance Determinant) estimates, which are computed from a subset of points designed to downweight outliers and better represent the bulk of the data. In both cases we compare squared distances to the 97.5% quantile of a chi-square distribution with <code>p</code> degrees of freedom (<code>p</code> = number of numeric variables), treating points above this cutoff as potential outliers.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>md_classic <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  num_vars,                              <span class="co"># data matrix</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> <span class="fu">colMeans</span>(num_vars),           <span class="co"># classic mean vector</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> S_classic                        <span class="co"># classic covariance matrix</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">ncol</span>(num_vars))  <span class="co"># 97.5% chi-square threshold</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust (MCD) Mahalanobis distances</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>cmcd <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">covMcd</span>(num_vars)     <span class="co"># robust center/covariance via MCD</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>md_robust <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  num_vars,                              <span class="co"># data matrix</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> cmcd<span class="sc">$</span>center,                  <span class="co"># robust center</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> cmcd<span class="sc">$</span>cov                         <span class="co"># robust covariance</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                     <span class="co"># two plots side by side</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md_classic, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">"Mahalanobis (classic)"</span>, <span class="at">ylab =</span> <span class="st">"Distance"</span>)  <span class="co"># classic distances</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)                                       <span class="co"># cutoff line</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md_robust, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">"Mahalanobis (robust MCD)"</span>, <span class="at">ylab =</span> <span class="st">"Distance"</span>) <span class="co"># robust distances</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)                                       <span class="co"># cutoff line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                     <span class="co"># reset layout</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>flag_classic <span class="ot">&lt;-</span> <span class="fu">which</span>(md_classic <span class="sc">&gt;</span> cutoff)    <span class="co"># indices flagged by classic distance</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>flag_robust  <span class="ot">&lt;-</span> <span class="fu">which</span>(md_robust  <span class="sc">&gt;</span> cutoff)    <span class="co"># indices flagged by robust distance</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>out_table <span class="ot">&lt;-</span> <span class="fu">list</span>(                            <span class="co"># collect flagged machines</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">classical =</span> <span class="fu">data.frame</span>(                                       <span class="co"># classic flagged table</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">machine =</span> machines_sub<span class="sc">$</span>machine[flag_classic],       <span class="co"># names flagged (classic)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">round</span>(md_classic[flag_classic], <span class="dv">2</span>)       <span class="co"># classic distances</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">robust =</span> <span class="fu">data.frame</span>(                                          <span class="co"># robust flagged table</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">machine =</span> machines_sub<span class="sc">$</span>machine[flag_robust],        <span class="co"># names flagged (robust)</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">round</span>(md_robust[flag_robust], <span class="dv">2</span>)         <span class="co"># robust distances</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>out_table                                   <span class="co"># show both tables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Interpretation: both classical and robust distances keep most machines below the 97.5% cutoff (≈17.5), showing a fairly homogeneous core around a single multivariate centre. The classical rule flags 5 candidate outliers (mostly high-end IBM and Honeywell models), while the robust MCD rule flags 16, including additional high-performance and large-memory systems. The robust method is more sensitive here because it estimates centre and scatter from the bulk of the data: this tightens the covariance ellipsoid around typical machines, so extreme configurations fall more clearly beyond the chi-square threshold. In contrast, the classical covariance is inflated by the same extreme points it is trying to detect, which stretches the ellipsoid and can mask some moderate outliers.</p>
</section>
<section id="summary-of-the-preliminary-analysis" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="summary-of-the-preliminary-analysis"><span class="header-section-number">5.4</span> Summary of the preliminary analysis</h2>
<p>Overall, the subset contains 41 machines with heterogeneous hardware characteristics (<code>MMIN</code>, <code>MMAX</code>, <code>CACH</code>, channel counts and performance metrics). The comparison between mean, median, trimmed and winsorized means, together with the MAD values, highlights variables where the bulk of the data is concentrated but a few machines deviate substantially from the main group. The covariance matrix and Mahalanobis distances confirm this picture: most observations form a compact cloud near a common centre, while a small number of models, such as <code>honeywell-dps:6/96</code>, <code>ibm-3081</code> and <code>honeywell-dps:8/49</code>, display unusually large memory, cache and performance values and are flagged as multivariate outliers.</p>
<p>This preliminary step already suggests a dominant “size/performance” gradient in the data, ranging from modest systems to high-end machines. This motivates the use of PCA in the next section to summarise that multivariate structure with a reduced number of components while retaining most of the total variance.</p>
</section>
</section>
<section id="principal-component-analysis-original-vs-standardized" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Principal Component Analysis (original vs standardized)</h1>
<p>We compare PCA on raw scales (keeps original units) vs standardized (puts variables on equal footing).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>pca_raw <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(num_vars, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)   <span class="co"># PCA on raw scale</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>pca_std <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(num_vars, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)    <span class="co"># PCA on standardized data</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure numeric to avoid class quirks on sdev</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>sdev_raw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pca_raw<span class="sc">$</span>sdev)                         <span class="co"># SDs of PCs (raw)</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>sdev_std <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pca_std<span class="sc">$</span>sdev)                         <span class="co"># SDs of PCs (std)</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>pve_raw <span class="ot">&lt;-</span> sdev_raw<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sdev_raw<span class="sc">^</span><span class="dv">2</span>)                      <span class="co"># proportion variance explained (raw)</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>pve_std <span class="ot">&lt;-</span> sdev_std<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sdev_std<span class="sc">^</span><span class="dv">2</span>)                      <span class="co"># proportion variance explained (std)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="scree-plots-and-variance-explained" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="scree-plots-and-variance-explained"><span class="header-section-number">6.1</span> Scree plots and variance explained</h2>
<p>Red line marks 95% cumulative variance target.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                                          <span class="co"># side-by-side scree plots</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve_raw <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">"PC"</span>, <span class="at">ylab =</span> <span class="st">"% variance"</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Raw scale"</span>)                                      <span class="co"># raw PVE</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">cumsum</span>(pve_raw) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)        <span class="co"># cumulative PVE (raw)</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">95</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)                          <span class="co"># 95% line</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve_std <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">"PC"</span>, <span class="at">ylab =</span> <span class="st">"% variance"</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Standardized"</span>)                                   <span class="co"># standardized PVE</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">cumsum</span>(pve_std) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)        <span class="co"># cumulative PVE (std)</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">95</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>)                          <span class="co"># 95% line</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                                          <span class="co"># reset layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>k_raw <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(pve_raw) <span class="sc">&gt;=</span> <span class="fl">0.95</span>)[<span class="dv">1</span>]                    <span class="co"># PCs needed (raw) for 95%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>k_std <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(pve_std) <span class="sc">&gt;=</span> <span class="fl">0.95</span>)[<span class="dv">1</span>]                    <span class="co"># PCs needed (std) for 95%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="fu">c</span>(<span class="st">"raw"</span>, <span class="st">"standardized"</span>),                           <span class="co"># scale type</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcs_needed_for_95pct =</span> <span class="fu">c</span>(k_raw, k_std),                     <span class="co"># count of PCs to reach 95%</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cumulative_variance =</span> <span class="fu">c</span>(<span class="fu">cumsum</span>(pve_raw)[k_raw], <span class="fu">cumsum</span>(pve_std)[k_std])  <span class="co"># achieved cum PVE</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>)                                                           <span class="co"># show summary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["scale"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pcs_needed_for_95pct"],"name":[2],"type":["int"],"align":["right"]},{"label":["cumulative_variance"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"raw","2":"2","3":"0.9994522"},{"1":"standardized","2":"5","3":"0.9724443"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Interpretation: - On the original scale, <code>PC1</code> alone explains about 94% of the total variance and <code>PC1</code>–<code>PC2</code> together almost 100%, but this summary is dominated by the variables measured on larger scales (memory and performance), so it is less suitable for comparing the relative importance of all variables. - On the standardized scale, <code>PC1</code> explains roughly 65% of the variance and <code>PC1</code>–<code>PC2</code> together about 80%, with the first 5 PCs needed to reach the 95% threshold; this represents a clear reduction from the original 8 dimensions while keeping most of the multivariate information. - The loadings table for the standardized PCA (next subsection) shows that <code>PC1</code> is dominated by memory and performance variables, whereas <code>PC2</code> contrasts channel capacity (<code>CHMAX</code>) with cycle time and minimum channels; we interpret these as a “capacity/performance” axis and an “I/O-versus-speed” axis, respectively. - For dimension reduction and interpretation we therefore focus on the standardized PCA and retain the first 5 components, reading PC1 as an overall performance/memory scale and PC2 as a channels-versus-speed dimension; the remaining retained PCs mainly capture subtler contrasts among already powerful machines.</p>
</section>
<section id="loadings-and-interpretation-aids" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="loadings-and-interpretation-aids"><span class="header-section-number">6.2</span> Loadings and interpretation aids</h2>
<p>To make the previous interpretation concrete, we inspect which variables drive the first standardized PCs (signs may flip without changing interpretation).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>loadings_std <span class="ot">&lt;-</span> <span class="fu">round</span>(pca_std<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="dv">3</span>)   <span class="co"># loadings for PCs 1 and 2 (standardized PCA)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>loadings_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         PC1    PC2
MYCT   0.261 -0.399
MMIN  -0.386 -0.289
MMAX  -0.387  0.167
CACH  -0.370  0.014
CHMIN -0.333 -0.253
CHMAX -0.139  0.800
PRP   -0.429 -0.147
ERP   -0.427 -0.061</code></pre>
</div>
</div>
</section>
<section id="scores-plot-first-two-pcs" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="scores-plot-first-two-pcs"><span class="header-section-number">6.3</span> Scores plot (first two PCs)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>scores_std <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_std<span class="sc">$</span>x)                    <span class="co"># PCA scores (std)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>scores_std<span class="sc">$</span>machine <span class="ot">&lt;-</span> machines_sub<span class="sc">$</span>machine               <span class="co"># add machine names</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(scores_std<span class="sc">$</span>PC1, scores_std<span class="sc">$</span>PC2, <span class="at">pch =</span> <span class="dv">19</span>,           <span class="co"># scatter of PC1 vs PC2</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"PC1 (std)"</span>, <span class="at">ylab =</span> <span class="st">"PC2 (std)"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scores on standardized data"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(scores_std<span class="sc">$</span>PC1, scores_std<span class="sc">$</span>PC2, <span class="at">labels =</span> scores_std<span class="sc">$</span>machine,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)                                 <span class="co"># label points</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: the standardized score plot shows where machines align along the performance/memory axis (PC1) and the channels-vs-speed axis (PC2). In our sign convention, higher-performance, higher-memory machines have large negative PC1 scores (to the left), while lower-capacity systems lie towards the right; the vertical spread reflects different channel configurations relative to cycle time. Labels make it easy to relate extreme scores back to specific models when discussing results.</p>
</section>
</section>
<section id="outlier-experiment" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Outlier experiment</h1>
<p>Introduce the atypical point at the former <code>hp-3000/64</code> row (no standardization).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>xnew <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">2000</span>, <span class="fl">0.8</span>, <span class="dv">80000</span>, <span class="dv">300</span>, <span class="dv">24</span>, <span class="dv">62</span>, <span class="dv">47</span>)          <span class="co"># injected outlier values</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>machines_out <span class="ot">&lt;-</span> machines_sub                              <span class="co"># start from subset</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>machines_out[machines_out<span class="sc">$</span>machine <span class="sc">==</span> <span class="st">"hp-3000/64"</span>, <span class="fu">names</span>(num_vars)] <span class="ot">&lt;-</span> xnew  <span class="co"># replace row</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>pca_out_classic <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(machines_out[<span class="fu">names</span>(num_vars)], <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)   <span class="co"># classic PCA with outlier</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>pca_out_robust <span class="ot">&lt;-</span> <span class="fu">PcaCov</span>(machines_out[<span class="fu">names</span>(num_vars)], <span class="at">cov.control =</span> <span class="fu">CovControlMcd</span>(), <span class="at">scale =</span> <span class="cn">FALSE</span>)  <span class="co"># robust PCA</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>pve_out_classic <span class="ot">&lt;-</span> pca_out_classic<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca_out_classic<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># PVE classic</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>pve_out_robust <span class="ot">&lt;-</span> pca_out_robust<span class="sc">@</span>eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(pca_out_robust<span class="sc">@</span>eigenvalues)  <span class="co"># PVE robust</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">component =</span> <span class="fu">seq_along</span>(pve_out_classic),                 <span class="co"># component index</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">classic_pct =</span> <span class="fu">round</span>(pve_out_classic <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),          <span class="co"># classic PVE (%)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">robust_pct =</span> <span class="fu">round</span>(pve_out_robust <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)             <span class="co"># robust PVE (%)</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This comparison of variance shares shows that the injected outlier substantially changes the classical PCA: the proportion of variance explained by the leading components is redistributed (roughly 58% and 40% for the first two PCs, rather than about 94% and 6% in the uncontaminated analysis), indicating that the first axes are now driven by the extreme point. In practical terms, the classical PCs are no longer summarising the variability among typical machines but are instead oriented to separate the modified <code>hp-3000/64</code> from the rest. In contrast, the robust PCA eigenvalues remain close to those obtained without the outlier (around 92% for the first component and 7% for the second), so the bulk geometry of the original data is largely preserved.</p>
<section id="visual-comparison-scores" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="visual-comparison-scores"><span class="header-section-number">7.1</span> Visual comparison: scores</h2>
<p>Outlier effect: in classical PCA, the first axes are strongly influenced by the extreme point; robust PCA should stay closer to the bulk structure.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                                       <span class="co"># two plots</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_classic<span class="sc">$</span>x[,<span class="dv">1</span>], pca_out_classic<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Classic PCA with outlier"</span>, <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>)  <span class="co"># classic scores</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca_out_classic<span class="sc">$</span>x[,<span class="dv">1</span>], pca_out_classic<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> machines_out<span class="sc">$</span>machine, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)              <span class="co"># labels</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_robust<span class="sc">@</span>scores[,<span class="dv">1</span>], pca_out_robust<span class="sc">@</span>scores[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Robust PCA (MCD)"</span>, <span class="at">xlab =</span> <span class="st">"PC1"</span>, <span class="at">ylab =</span> <span class="st">"PC2"</span>)          <span class="co"># robust scores</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca_out_robust<span class="sc">@</span>scores[,<span class="dv">1</span>], pca_out_robust<span class="sc">@</span>scores[,<span class="dv">2</span>],</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> machines_out<span class="sc">$</span>machine, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)              <span class="co"># labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                                       <span class="co"># reset layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In the classical scores plot with the outlier, the modified <code>hp-3000/64</code> appears in the far upper-right quadrant with extremely large <code>PC1</code> and <code>PC2</code> scores, while high-end IBM machines (such as <code>ibm-3081</code> and <code>ibm-3083:b</code>) lie far to the upper left with large positive <code>PC2</code> and large negative <code>PC1</code>. The remaining machines form a central cloud that is visually compressed by comparison, indicating that the first classical components are now mainly separating these few extreme configurations from the rest of the sample. In the robust scores plot, the modified observation is still clearly separated from the bulk, but the overall cloud of machines—and the orientation of the principal directions—remains much closer to the uncontaminated PCA, so the robust components continue to describe variability among typical configurations rather than being dominated by the single injected outlier.</p>
<section id="distance-diagnostics-robust-pca" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="distance-diagnostics-robust-pca"><span class="header-section-number">7.1.1</span> Distance diagnostics (robust PCA)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_robust)  <span class="co"># outlier map: orthogonal vs score distances</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="report_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>In this outlier map the horizontal axis shows the score distance, which measures how far an observation lies within the PCA subspace (essentially the length of its score vector after scaling by the robust eigenvalues). The vertical axis shows the orthogonal distance, which measures how far the observation lies from the PCA subspace itself (the norm of the reconstruction residual). Points with small score and orthogonal distances belong to the central cloud. Observations with large score distance but small orthogonal distance are leverage points within the PCA structure, whereas those with large orthogonal distance are “off-plane” outliers that are poorly represented by the retained components. The modified <code>hp-3000/64</code> appears in the upper part of this plot, confirming that it is a clear outlier relative to the robust PCA model.</p>
</section>
</section>
</section>
<section id="decisions" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Decisions</h1>
<ul>
<li>For exploratory analysis we rely on classical summaries to describe central tendency and spread, but interpret them in parallel with robust statistics (trimmed and winsorized means, MAD and MCD-based Mahalanobis distances) to avoid being misled by a few extreme machines.</li>
<li>For dimension reduction we base our decision on the proportion of variance explained and interpretability of the loadings: we favour the standardized PCA and retain the first 5 principal components, which already explain at least 95% of the total variance in the eight numeric variables.</li>
<li>When a single atypical observation is present, we use robust PCA based on the MCD covariance estimate to describe the multivariate structure of the bulk of the data, and treat the classical PCA mainly as a diagnostic to illustrate the effect of the outlier.</li>
</ul>
</section>
<section id="conclusions" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Conclusions</h1>
<p>The subset of <code>machines</code> data considered here exhibits a clear gradient from low to high capability systems, mainly driven by memory size, cache and performance measures. The preliminary analysis using classical and robust summaries, together with Mahalanobis distances, shows that most machines cluster around a central configuration while a small number of high-end models stand out as multivariate outliers.</p>
<p>Standardized PCA provides an effective summary of this structure: with only 5 components we retain at least 95% of the total variance and obtain interpretable directions, where the first component captures an overall performance/memory level and the second contrasts channel capacity with speed. Plotting the scores on these components reveals how specific named machines occupy different regions of the performance–channels trade-off.</p>
<p>After injecting the artificial outlier, classical PCA becomes strongly influenced by this single observation, reallocating a large share of variance to the first component and distorting the geometry of the remaining points. In contrast, the MCD-based robust PCA keeps the eigenvalues and loading patterns closer to the original analysis and clearly isolates the modified machine in the outlier map. This comparison illustrates the vulnerability of classical PCA to even one atypical observation and motivates the use of robust methods when data contamination is plausible.</p>
</section>
<section id="bibliography" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Bibliography</h1>
<ul>
<li>Jolliffe, I. T. (2002). <em>Principal Component Analysis</em>. Springer.</li>
<li>Todorov, V., &amp; Filzmoser, P. (2009). An object oriented framework for robust multivariate analysis. <em>Journal of Statistical Software</em>, 32(3), 1–47. ***</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>