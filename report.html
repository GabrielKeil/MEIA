<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.7.32" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Grupo" />
<meta name="dcterms.date" content="2025-12-09" />

<title>PCA and Outlier Analysis on Machines Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->
<link href="report_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="report_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <div id="quarto-toc-target"></div>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PCA and Outlier Analysis on Machines Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Grupo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul>
  <li><a href="#objectives-of-the-study" id="toc-objectives-of-the-study"><span class="header-section-number">1.1</span> Objectives of the study</a></li>
  </ul></li>
  <li><a href="#study-plan-at-a-glance" id="toc-study-plan-at-a-glance"><span class="header-section-number">2</span> Study plan (at a glance)</a></li>
  <li><a href="#setup-and-data" id="toc-setup-and-data"><span class="header-section-number">3</span> Setup and data</a></li>
  <li><a href="#data-description" id="toc-data-description"><span class="header-section-number">4</span> Data description</a></li>
  <li><a href="#exploratory-summaries" id="toc-exploratory-summaries"><span class="header-section-number">5</span> Exploratory summaries</a>
  <ul>
  <li><a href="#classical-vs-robust-locationscale" id="toc-classical-vs-robust-locationscale"><span class="header-section-number">5.1</span> Classical vs robust location/scale</a></li>
  <li><a href="#covariance-total-and-generalized-variance" id="toc-covariance-total-and-generalized-variance"><span class="header-section-number">5.2</span> Covariance, total and generalized variance</a></li>
  <li><a href="#mahalanobis-distances-classical" id="toc-mahalanobis-distances-classical"><span class="header-section-number">5.3</span> Mahalanobis distances (classical)</a>
  <ul>
  <li><a href="#who-is-flagged-and-which-variables-drive-them" id="toc-who-is-flagged-and-which-variables-drive-them"><span class="header-section-number">5.3.1</span> Who is flagged and which variables drive them?</a></li>
  </ul></li>
  <li><a href="#summary-of-the-preliminary-analysis" id="toc-summary-of-the-preliminary-analysis"><span class="header-section-number">5.4</span> Summary of the preliminary analysis</a></li>
  </ul></li>
  <li><a href="#principal-component-analysis-original-vs-standardized" id="toc-principal-component-analysis-original-vs-standardized"><span class="header-section-number">6</span> Principal Component Analysis (original vs standardized)</a>
  <ul>
  <li><a href="#scree-plots-and-variance-explained" id="toc-scree-plots-and-variance-explained"><span class="header-section-number">6.1</span> Scree plots and variance explained</a></li>
  <li><a href="#loadings-and-interpretation-aids" id="toc-loadings-and-interpretation-aids"><span class="header-section-number">6.2</span> Loadings and interpretation aids</a></li>
  <li><a href="#scores-plot-first-two-pcs" id="toc-scores-plot-first-two-pcs"><span class="header-section-number">6.3</span> Scores plot (first two PCs)</a></li>
  </ul></li>
  <li><a href="#outlier-experiment" id="toc-outlier-experiment"><span class="header-section-number">7</span> Outlier experiment</a>
  <ul>
  <li><a href="#visual-comparison-scores" id="toc-visual-comparison-scores"><span class="header-section-number">7.1</span> Visual comparison: scores</a>
  <ul>
  <li><a href="#distance-diagnostics-robust-pca" id="toc-distance-diagnostics-robust-pca"><span class="header-section-number">7.1.1</span> Distance diagnostics (robust PCA)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#decisions" id="toc-decisions"><span class="header-section-number">8</span> Decisions</a></li>
  <li><a href="#conclusions" id="toc-conclusions"><span class="header-section-number">9</span> Conclusions</a></li>
  <li><a href="#bibliography" id="toc-bibliography"><span class="header-section-number">10</span> Bibliography</a></li>
  </ul>
</nav>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This report walks through an analysis of a subset of the <code>machines</code> data from the <code>rrcov</code> package (rows <strong>hp-3000/64</strong> to <strong>ibm-4331-2</strong>).</p>
<section id="objectives-of-the-study" class="level2" data-number="1.1">
<h2 data-number="1.1"><span class="header-section-number">1.1</span> Objectives of the study</h2>
<ul>
<li>Describe the variables using classical and robust summaries, Mahalanobis distances and graphical tools, and comment on the main patterns in the data.</li>
<li>Apply PCA on the original and standardized scales, compare the proportion of explained variance and interpret the retained components (keeping at least 95% of total variance).</li>
<li>Introduce a single atypical observation and compare the impact on classical PCA versus a robust PCA based on the MCD estimate.</li>
</ul>
</section>
</section>
<section id="study-plan-at-a-glance" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Study plan (at a glance)</h1>
<ol type="1">
<li>Inspect the data: structure, variable meaning, rough scales.<br />
</li>
<li>Classical and robust summaries to see skew/tails and dependence (covariance, distances).<br />
</li>
<li>PCA on raw vs standardized variables; compare variance explained and loadings; pick components reaching 95%.<br />
</li>
<li>Inject one outlier and compare classical vs robust PCA to illustrate sensitivity.<br />
</li>
<li>Conclude and state a recommendation for which PCA to report and why.</li>
</ol>
</section>
<section id="setup-and-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Setup and data</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(c(&quot;rrcov&quot;, &quot;robustbase&quot;), repos = &quot;https://cloud.r-project.org&quot;)  # install if missing</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rrcov)          <span class="co"># robust multivariate methods (PCA, covariance)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(robustbase)     <span class="co"># robust basics (MCD, etc.)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(machines)          <span class="co"># load the machines dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>machines_sub <span class="ot">&lt;-</span> machines[<span class="dv">71</span><span class="sc">:</span><span class="dv">111</span>, ]                  <span class="co"># slice rows hp-3000/64 ... ibm-4331-2</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>machines_sub<span class="sc">$</span>machine <span class="ot">&lt;-</span> <span class="fu">rownames</span>(machines_sub)      <span class="co"># store machine names for labeling</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(machines_sub) <span class="ot">&lt;-</span> <span class="cn">NULL</span>                      <span class="co"># drop row names to avoid confusion</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>n_obs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(machines_sub)                         <span class="co"># count observations</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>n_vars <span class="ot">&lt;-</span> <span class="fu">ncol</span>(machines_sub) <span class="sc">-</span> <span class="dv">1</span>                    <span class="co"># count numeric variables (exclude machine names)</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(machines_sub, <span class="dv">3</span>)                               <span class="co"># peek at the first rows</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["MYCT"],"name":[1],"type":["int"],"align":["right"]},{"label":["MMIN"],"name":[2],"type":["int"],"align":["right"]},{"label":["MMAX"],"name":[3],"type":["int"],"align":["right"]},{"label":["CACH"],"name":[4],"type":["int"],"align":["right"]},{"label":["CHMIN"],"name":[5],"type":["int"],"align":["right"]},{"label":["CHMAX"],"name":[6],"type":["int"],"align":["right"]},{"label":["PRP"],"name":[7],"type":["int"],"align":["right"]},{"label":["ERP"],"name":[8],"type":["int"],"align":["right"]},{"label":["machine"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"75","2":"2000","3":"8000","4":"8","5":"3","6":"24","7":"62","8":"47","9":"hp-3000/64","_rn_":"1"},{"1":"75","2":"3000","3":"8000","4":"8","5":"3","6":"48","7":"64","8":"54","9":"hp-3000/88","_rn_":"2"},{"1":"175","2":"256","3":"2000","4":"0","5":"3","6":"24","7":"22","8":"20","9":"hp-3000/iii","_rn_":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize each variable (min/mean/median/max/quartiles)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(machines_sub)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      MYCT             MMIN            MMAX            CACH      
 Min.   :  26.0   Min.   :   96   Min.   :  512   Min.   : 0.00  
 1st Qu.: 140.0   1st Qu.:  768   1st Qu.: 3000   1st Qu.: 0.00  
 Median : 300.0   Median : 1000   Median : 4000   Median : 4.00  
 Mean   : 322.7   Mean   : 2435   Mean   : 9812   Mean   :10.41  
 3rd Qu.: 330.0   3rd Qu.: 2000   3rd Qu.:12000   3rd Qu.: 8.00  
 Max.   :1100.0   Max.   :16000   Max.   :32000   Max.   :64.00  
     CHMIN            CHMAX             PRP           ERP        
 Min.   : 1.000   Min.   :  1.00   Min.   :  6   Min.   : 15.00  
 1st Qu.: 1.000   1st Qu.:  2.00   1st Qu.: 22   1st Qu.: 23.00  
 Median : 1.000   Median : 20.00   Median : 38   Median : 30.00  
 Mean   : 3.171   Mean   : 20.39   Mean   : 80   Mean   : 69.34  
 3rd Qu.: 4.000   3rd Qu.: 24.00   3rd Qu.: 66   3rd Qu.: 57.00  
 Max.   :16.000   Max.   :112.00   Max.   :465   Max.   :361.00  
   machine         
 Length:41         
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
</section>
<section id="data-description" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Data description</h1>
<ul>
<li>Observations: 41 machines; numeric variables: 8.</li>
<li>Variables (all numeric):
<ul>
<li><code>MYCT</code> cycle time (ns), <code>MMIN</code> min memory (KB), <code>MMAX</code> max memory (KB), <code>CACH</code> cache (KB),<br />
</li>
<li><code>CHMIN</code> min channels, <code>CHMAX</code> max channels, <code>PRP</code> published perf, <code>ERP</code> estimated perf.<br />
</li>
</ul></li>
<li>Machine IDs live in <code>machine</code> (formerly row names). Use them for labels, not for analysis.</li>
</ul>
<p>Historically, these data come from the Computer Hardware dataset describing mainframe computers from the 1970s–1980s. Each row corresponds to a specific machine model, with hardware specifications (cycle time, memory, cache, number of I/O channels) and two performance measures. The variables <code>CHMIN</code> and <code>CHMAX</code> denote the minimum and maximum number of I/O channels the system can be configured with, so they reflect scalability for small versus large installations.</p>
<p>To make the variables more concrete, consider two machines in our subset:</p>
<ul>
<li><code>hp-3000/iii</code> has <code>MYCT = 175</code> ns (slower CPU), <code>MMIN = 256</code> KB and <code>MMAX = 2000</code> KB of memory, no cache and between 3 and 24 channels (<code>CHMIN = 3</code>, <code>CHMAX = 24</code>), with published performance <code>PRP = 22</code>. This is a relatively modest system in both memory and performance.</li>
<li><code>ibm-3081</code> has <code>MYCT = 26</code> ns (much faster), <code>MMIN = 16000</code> KB and <code>MMAX = 32000</code> KB of memory, cache <code>CACH = 64</code>, between 16 and 24 channels, and <code>PRP = 465</code>. It represents a high-end configuration with far greater memory and throughput capability.</li>
</ul>
<p>These contrasts illustrate how larger memory, more channels and lower cycle time are associated with higher performance measures, which is precisely the multivariate relationship we summarise with PCA in later sections.</p>
<p>Before any formal analysis, these hardware considerations give us clear prior expectations: we anticipate a strong negative association between <code>MYCT</code> and the performance variables, and positive associations between <code>MMIN</code>, <code>MMAX</code>, <code>CACH</code>, the channel counts and <code>PRP</code>/<code>ERP</code>. We also expect <code>PRP</code> and <code>ERP</code> to be highly correlated, since both are measuring the same underlying notion of computing power. In terms of PCA, a natural prior is that the leading standardized component will reflect an overall “size/performance” level combining memory, cache and performance, while a secondary component may capture differences in channel configuration relative to speed.</p>
<p>Quick look at the machine names:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(machines_sub<span class="sc">$</span>machine, <span class="dv">5</span>)                       <span class="co"># show first few machine IDs</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;hp-3000/64&quot;  &quot;hp-3000/88&quot;  &quot;hp-3000/iii&quot; &quot;harris-100&quot;  &quot;harris-300&quot; </code></pre>
</div>
</div>
<p>Helper functions for trimmed/winsorized means and total/generalized variance:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>winsor_mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>)) {</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  qs <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, probs, <span class="at">names =</span> <span class="cn">FALSE</span>)           <span class="co"># lower/upper cutoffs</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(<span class="fu">pmin</span>(<span class="fu">pmax</span>(x, qs[<span class="dv">1</span>]), qs[<span class="dv">2</span>]))                 <span class="co"># clamp extremes then average</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>total_variance <span class="ot">&lt;-</span> <span class="cf">function</span>(S) <span class="fu">sum</span>(<span class="fu">diag</span>(S))          <span class="co"># sum of variances (trace)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>generalized_variance <span class="ot">&lt;-</span> <span class="cf">function</span>(S) <span class="fu">determinant</span>(S, <span class="at">logarithm =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>modulus  <span class="co"># log-determinant</span></span></code></pre></div>
</details>
</div>
</section>
<section id="exploratory-summaries" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Exploratory summaries</h1>
<section id="classical-vs-robust-locationscale" class="level2" data-number="5.1">
<h2 data-number="5.1"><span class="header-section-number">5.1</span> Classical vs robust location/scale</h2>
<p>Focus: see how skew and heavy tails affect means; compare to median/trimmed/winsor/MAD.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>num_vars <span class="ot">&lt;-</span> machines_sub[ , <span class="fu">setdiff</span>(<span class="fu">names</span>(machines_sub), <span class="st">&quot;machine&quot;</span>)]  <span class="co"># numeric-only data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>stat_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(                              <span class="co"># assemble summary table</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="fu">names</span>(num_vars),                     <span class="co"># variable name</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean =</span> <span class="fu">sapply</span>(num_vars, mean),                  <span class="co"># arithmetic mean</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">median =</span> <span class="fu">sapply</span>(num_vars, median),              <span class="co"># median</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">trimmed_mean =</span> <span class="fu">sapply</span>(num_vars, mean, <span class="at">trim =</span> <span class="fl">0.1</span>),  <span class="co"># 10% trimmed mean</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">winsor_mean =</span> <span class="fu">sapply</span>(num_vars, winsor_mean),    <span class="co"># 5–95 winsorized mean</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">sd =</span> <span class="fu">sapply</span>(num_vars, sd),                      <span class="co"># standard deviation</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">var =</span> <span class="fu">sapply</span>(num_vars, var),                    <span class="co"># variance</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">mad =</span> <span class="fu">sapply</span>(num_vars, mad)                     <span class="co"># median absolute deviation</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>stat_table                                        <span class="co"># show table</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[3],"type":["int"],"align":["right"]},{"label":["trimmed_mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["winsor_mean"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["sd"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["var"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["mad"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"MYCT","2":"322.707317","3":"300","4":"276.575758","5":"312.951220","6":"301.747845","7":"9.105176e+04","8":"237.2160","_rn_":"MYCT"},{"1":"MMIN","2":"2435.121951","3":"1000","4":"1542.787879","5":"2050.341463","6":"3563.887261","7":"1.270129e+07","8":"1103.0544","_rn_":"MMIN"},{"1":"MMAX","2":"9811.707317","3":"4000","4":"8212.121212","5":"9829.268293","6":"10584.538663","7":"1.120325e+08","8":"4447.8000","_rn_":"MMAX"},{"1":"CACH","2":"10.414634","3":"4","4":"6.151515","5":"10.414634","6":"17.915043","7":"3.209488e+02","8":"5.9304","_rn_":"CACH"},{"1":"CHMIN","2":"3.170732","3":"1","4":"2.484848","5":"2.878049","6":"3.390446","7":"1.149512e+01","8":"0.0000","_rn_":"CHMIN"},{"1":"CHMAX","2":"20.390244","3":"20","4":"16.606061","5":"18.731707","6":"22.381776","7":"5.009439e+02","8":"20.7564","_rn_":"CHMAX"},{"1":"PRP","2":"80.000000","3":"38","4":"54.575758","5":"71.048780","6":"108.868728","7":"1.185240e+04","8":"32.6172","_rn_":"PRP"},{"1":"ERP","2":"69.341463","3":"30","4":"50.393939","5":"62.829268","6":"84.751286","7":"7.182780e+03","8":"17.7912","_rn_":"ERP"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>From this table we can see, for each variable, how sensitive the mean is to extreme values by comparing it with the median, the trimmed mean and the winsorized mean. Large differences between the mean and the robust summaries indicate asymmetric or heavy-tailed behaviour. The MAD column complements the standard deviation by providing a scale measure that is less influenced by atypical machines.</p>
</section>
<section id="covariance-total-and-generalized-variance" class="level2" data-number="5.2">
<h2 data-number="5.2"><span class="header-section-number">5.2</span> Covariance, total and generalized variance</h2>
<p>These give a sense of joint spread; generalized variance is the log-determinant (stable on the log scale).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>S_classic <span class="ot">&lt;-</span> <span class="fu">cov</span>(num_vars)                          <span class="co"># classical covariance matrix</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>total_var <span class="ot">&lt;-</span> <span class="fu">total_variance</span>(S_classic)              <span class="co"># total variance (trace)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>gen_var_log <span class="ot">&lt;-</span> <span class="fu">generalized_variance</span>(S_classic)      <span class="co"># log generalized variance</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariance_matrix =</span> S_classic,                  <span class="co"># covariance matrix</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_variance =</span> total_var,                     <span class="co"># total variance</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">generalized_variance_log =</span> gen_var_log          <span class="co"># log generalized variance</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>)                                                  <span class="co"># print results</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$covariance_matrix
               MYCT         MMIN         MMAX         CACH        CHMIN
MYCT     91051.7622  -432377.463  -1609363.49  -2092.07561  -440.823780
MMIN   -432377.4634 12701292.410  24690893.74  41241.87317  8756.653659
MMAX  -1609363.4878 24690893.737 112032458.71 138025.22439 17389.951220
CACH     -2092.0756    41241.873    138025.22    320.94878    33.402439
CHMIN     -440.8238     8756.654     17389.95     33.40244    11.495122
CHMAX    -2618.3579     3924.551     92296.42    110.28415     4.831707
PRP     -15881.2000   359417.800    968283.00   1556.55000   277.225000
ERP     -11618.7226   263724.107    820483.00   1253.72988   187.415244
             CHMAX        PRP         ERP
MYCT  -2618.357927 -15881.200 -11618.7226
MMIN   3924.551220 359417.800 263724.1073
MMAX  92296.417073 968283.000 820483.0024
CACH    110.284146   1556.550   1253.7299
CHMIN     4.831707    277.225    187.4152
CHMAX   500.943902    442.150    481.2134
PRP     442.150000  11852.400   8981.1000
ERP     481.213415   8981.100   7182.7805

$total_variance
[1] 124844671

$generalized_variance_log
[1] 67.78829
attr(,&quot;logarithm&quot;)
[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="mahalanobis-distances-classical" class="level2" data-number="5.3">
<h2 data-number="5.3"><span class="header-section-number">5.3</span> Mahalanobis distances (classical)</h2>
<p>Note: the squared Mahalanobis distance is approximately chi-square with <code>p</code> degrees of freedom (<code>p</code> = number of numeric variables). Using the 97.5th percentile cutoff marks points that are unusually far from the multivariate center (potential joint outliers).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>md_classic <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  num_vars,                              <span class="co"># data matrix</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> <span class="fu">colMeans</span>(num_vars),           <span class="co"># classic mean vector</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> S_classic                        <span class="co"># classic covariance matrix</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>cutoff <span class="ot">&lt;-</span> <span class="fu">qchisq</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">ncol</span>(num_vars))  <span class="co"># 97.5% chi-square threshold</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Robust (MCD) Mahalanobis distances</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>cmcd <span class="ot">&lt;-</span> robustbase<span class="sc">::</span><span class="fu">covMcd</span>(num_vars)     <span class="co"># robust center/covariance via MCD</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>md_robust <span class="ot">&lt;-</span> <span class="fu">mahalanobis</span>(</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  num_vars,                              <span class="co"># data matrix</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">center =</span> cmcd<span class="sc">$</span>center,                  <span class="co"># robust center</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">cov =</span> cmcd<span class="sc">$</span>cov                         <span class="co"># robust covariance</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                     <span class="co"># two plots side by side</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md_classic, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;Mahalanobis (classic)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distance&quot;</span>)  <span class="co"># classic distances</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)                                       <span class="co"># cutoff line</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(md_robust, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">main =</span> <span class="st">&quot;Mahalanobis (robust MCD)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Distance&quot;</span>) <span class="co"># robust distances</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> cutoff, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)                                       <span class="co"># cutoff line</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                     <span class="co"># reset layout</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>flag_classic <span class="ot">&lt;-</span> <span class="fu">which</span>(md_classic <span class="sc">&gt;</span> cutoff)    <span class="co"># indices flagged by classic distance</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>flag_robust  <span class="ot">&lt;-</span> <span class="fu">which</span>(md_robust  <span class="sc">&gt;</span> cutoff)    <span class="co"># indices flagged by robust distance</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>out_table <span class="ot">&lt;-</span> <span class="fu">list</span>(                            <span class="co"># collect flagged machines</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">classical =</span> <span class="fu">data.frame</span>(                                       <span class="co"># classic flagged table</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">machine =</span> machines_sub<span class="sc">$</span>machine[flag_classic],       <span class="co"># names flagged (classic)</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">round</span>(md_classic[flag_classic], <span class="dv">2</span>)       <span class="co"># classic distances</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">robust =</span> <span class="fu">data.frame</span>(                                          <span class="co"># robust flagged table</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">machine =</span> machines_sub<span class="sc">$</span>machine[flag_robust],        <span class="co"># names flagged (robust)</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">distance =</span> <span class="fu">round</span>(md_robust[flag_robust], <span class="dv">2</span>)         <span class="co"># robust distances</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>out_table                                   <span class="co"># show both tables</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$classical
             machine distance
1 honeywell-dps:6/96    22.52
2         ibm-3033:u    26.82
3           ibm-3081    23.13
4         ibm-3081:d    23.20
5         ibm-3083:b    19.11

$robust
              machine  distance
1          hp-3000/64    119.24
2          hp-3000/88    298.05
3          harris-500    199.95
4          harris-700    142.50
5          harris-800    193.55
6  honeywell-dps:6/96    836.62
7  honeywell-dps:8/49  18357.81
8  honeywell-dps:8/50    184.89
9  honeywell-dps:8/52  21019.73
10 honeywell-dps:8/62  20905.97
11         ibm-3033:s   1378.90
12         ibm-3033:u  17778.19
13           ibm-3081 161183.02
14         ibm-3081:d 143480.93
15         ibm-3083:b  44269.42
16         ibm-3083:e   5733.22</code></pre>
</div>
</div>
<p>Interpretation: both classic and robust distances keep most machines below the 97.5% cutoff (≈17.5), showing a fairly homogeneous core of machines around a single multivariate centre. A smaller group lies above the cutoff in at least one of the two metrics; these correspond to atypical combinations of cycle time, memory, cache and channels. The robust MCD distances sometimes flag a slightly different set because they estimate centre and scatter after downweighting potential outliers, which is desirable when searching for systematically atypical configurations.</p>
<section id="who-is-flagged-and-which-variables-drive-them" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1"><span class="header-section-number">5.3.1</span> Who is flagged and which variables drive them?</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>flagged_ids <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(flag_classic, flag_robust))   <span class="co"># union of flagged indices</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>center_c <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(num_vars)                        <span class="co"># classic center</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>scale_c <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(S_classic))                      <span class="co"># classic scales (SDs)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>center_r <span class="ot">&lt;-</span> cmcd<span class="sc">$</span>center                               <span class="co"># robust center</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>scale_r <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(cmcd<span class="sc">$</span>cov))                       <span class="co"># robust scales (SDs)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Approximate per-variable contributions: squared standardized deviations (ignores correlation structure)</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>contrib_mat_classic <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(num_vars[flagged_ids, ], <span class="dv">1</span>, <span class="cf">function</span>(x) ((x <span class="sc">-</span> center_c) <span class="sc">/</span> scale_c)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>contrib_mat_robust  <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(num_vars[flagged_ids, ], <span class="dv">1</span>, <span class="cf">function</span>(x) ((x <span class="sc">-</span> center_r) <span class="sc">/</span> scale_r)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(contrib_mat_classic) <span class="ot">&lt;-</span> machines_sub<span class="sc">$</span>machine[flagged_ids]  <span class="co"># label rows</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(contrib_mat_robust)  <span class="ot">&lt;-</span> machines_sub<span class="sc">$</span>machine[flagged_ids]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(flagged_ids)) {                   <span class="co"># loop each flagged machine</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  mid <span class="ot">&lt;-</span> machines_sub<span class="sc">$</span>machine[flagged_ids[i]]         <span class="co"># machine name</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  op <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))     <span class="co"># two barplots side by side</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(contrib_mat_classic[i, ], <span class="at">main =</span> <span class="fu">paste</span>(mid, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">classic z^2&quot;</span>), <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span>, <span class="at">ylab =</span> <span class="st">&quot;contrib&quot;</span>)  <span class="co"># classic contributions</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">barplot</span>(contrib_mat_robust[i, ],  <span class="at">main =</span> <span class="fu">paste</span>(mid, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">robust z^2&quot;</span>),  <span class="at">las =</span> <span class="dv">2</span>, <span class="at">cex.names =</span> <span class="fl">0.7</span>, <span class="at">ylab =</span> <span class="st">&quot;contrib&quot;</span>)  <span class="co"># robust contributions</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(op)                                             <span class="co"># reset par</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-4.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-5.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-6.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-7.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-8.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-9.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-10.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-11.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-12.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-13.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-14.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-15.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-8-16.png" class="img-fluid" width="960" /></p>
</figure>
</div>
</div>
</div>
<p>Interpretation guide: - These barplots show which variables have the largest squared standardized deviations for each flagged machine (left: classical center/scale; right: robust center/scale). - Large bars point to the specs driving the outlying Mahalanobis distance (e.g., unusually high memory, channels, or performance). - Robust scaling tempers the influence of the bulk; if a bar stays large in both panels, that variable is a consistent driver of atypicality.</p>
<p>Friendly readout of three examples:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>examples <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;honeywell-dps:6/96&quot;</span>, <span class="st">&quot;ibm-3081&quot;</span>, <span class="st">&quot;honeywell-dps:8/49&quot;</span>)  <span class="co"># pick 3 machines</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>get_top <span class="ot">&lt;-</span> <span class="cf">function</span>(mat, id, <span class="at">k =</span> <span class="dv">3</span>) {                                  <span class="co"># helper to grab top k contributions</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>id <span class="sc">%in%</span> <span class="fu">rownames</span>(mat)) <span class="fu">return</span>(<span class="cn">NA</span>)                               <span class="co"># handle missing</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sort</span>(mat[id, ], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span>k]                              <span class="co"># largest k entries</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>example_top <span class="ot">&lt;-</span> <span class="fu">lapply</span>(examples, <span class="cf">function</span>(id) {                         <span class="co"># build list for each example</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">machine =</span> id,                                                      <span class="co"># machine name</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">classic_top =</span> <span class="fu">round</span>(<span class="fu">get_top</span>(contrib_mat_classic, id), <span class="dv">2</span>),          <span class="co"># top classic contributors</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">robust_top =</span> <span class="fu">round</span>(<span class="fu">get_top</span>(contrib_mat_robust, id), <span class="dv">2</span>)             <span class="co"># top robust contributors</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>example_top                                                            <span class="co"># show the list</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$machine
[1] &quot;honeywell-dps:6/96&quot;

[[1]]$classic_top
CHMAX  MMAX  MMIN 
16.75  0.34  0.16 

[[1]]$robust_top
 MMAX   ERP CHMAX 
42.02 37.79 36.96 


[[2]]
[[2]]$machine
[1] &quot;ibm-3081&quot;

[[2]]$classic_top
 MMIN CHMIN   PRP 
14.49 14.32 12.51 

[[2]]$robust_top
    ERP     PRP    MMIN 
1846.45  982.37  240.27 


[[3]]
[[3]]$machine
[1] &quot;honeywell-dps:8/49&quot;

[[3]]$classic_top
MMAX  ERP CACH 
4.39 1.55 1.45 

[[3]]$robust_top
   ERP   MMAX    PRP 
368.21 211.48  59.85 </code></pre>
</div>
</div>
<ul>
<li><code>honeywell-dps:6/96</code>: dominated by very high <code>CHMAX</code> (channels), with moderate influence from <code>MMAX</code> and <code>ERP</code> in the robust view.</li>
<li><code>ibm-3081</code>: extreme across memory (<code>MMIN</code>, <code>MMAX</code>), cache, and performance (<code>PRP</code>, <code>ERP</code>), especially in the robust scaling where these dwarfish deviations inflate the distance.</li>
<li><code>honeywell-dps:8/49</code>: stands out for large <code>MMAX</code> and <code>CACH</code>, coupled with higher <code>PRP</code>/<code>ERP</code> relative to the robust center.</li>
</ul>
</section>
</section>
<section id="summary-of-the-preliminary-analysis" class="level2" data-number="5.4">
<h2 data-number="5.4"><span class="header-section-number">5.4</span> Summary of the preliminary analysis</h2>
<p>Overall, the subset contains 41 machines with heterogeneous hardware characteristics (<code>MMIN</code>, <code>MMAX</code>, <code>CACH</code>, channel counts and performance metrics). The comparison between mean, median, trimmed and winsorized means, together with the MAD values, highlights variables where the bulk of the data is concentrated but a few machines deviate substantially from the main group. The covariance matrix and Mahalanobis distances confirm this picture: most observations form a compact cloud near a common centre, while a small number of models, such as <code>honeywell-dps:6/96</code>, <code>ibm-3081</code> and <code>honeywell-dps:8/49</code>, display unusually large memory, cache and performance values and are flagged as multivariate outliers.</p>
<p>This preliminary step already suggests a dominant “size/performance” gradient in the data, ranging from modest systems to high-end machines. This motivates the use of PCA in the next section to summarise that multivariate structure with a reduced number of components while retaining most of the total variance.</p>
</section>
</section>
<section id="principal-component-analysis-original-vs-standardized" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Principal Component Analysis (original vs standardized)</h1>
<p>We compare PCA on raw scales (keeps original units) vs standardized (puts variables on equal footing).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>pca_raw <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(num_vars, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)   <span class="co"># PCA on raw scale</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>pca_std <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(num_vars, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">TRUE</span>)    <span class="co"># PCA on standardized data</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ensure numeric to avoid class quirks on sdev</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sdev_raw <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pca_raw<span class="sc">$</span>sdev)                         <span class="co"># SDs of PCs (raw)</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>sdev_std <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(pca_std<span class="sc">$</span>sdev)                         <span class="co"># SDs of PCs (std)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>pve_raw <span class="ot">&lt;-</span> sdev_raw<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sdev_raw<span class="sc">^</span><span class="dv">2</span>)                      <span class="co"># proportion variance explained (raw)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>pve_std <span class="ot">&lt;-</span> sdev_std<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(sdev_std<span class="sc">^</span><span class="dv">2</span>)                      <span class="co"># proportion variance explained (std)</span></span></code></pre></div>
</details>
</div>
<section id="scree-plots-and-variance-explained" class="level2" data-number="6.1">
<h2 data-number="6.1"><span class="header-section-number">6.1</span> Scree plots and variance explained</h2>
<p>Red line marks 95% cumulative variance target.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                                          <span class="co"># side-by-side scree plots</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve_raw <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">&quot;PC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;% variance&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Raw scale&quot;</span>)                                      <span class="co"># raw PVE</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">cumsum</span>(pve_raw) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)        <span class="co"># cumulative PVE (raw)</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">95</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)                          <span class="co"># 95% line</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pve_std <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">xlab =</span> <span class="st">&quot;PC&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;% variance&quot;</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Standardized&quot;</span>)                                   <span class="co"># standardized PVE</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">cumsum</span>(pve_std) <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)        <span class="co"># cumulative PVE (std)</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">95</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)                          <span class="co"># 95% line</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                                          <span class="co"># reset layout</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>k_raw <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(pve_raw) <span class="sc">&gt;=</span> <span class="fl">0.95</span>)[<span class="dv">1</span>]                    <span class="co"># PCs needed (raw) for 95%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>k_std <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(pve_std) <span class="sc">&gt;=</span> <span class="fl">0.95</span>)[<span class="dv">1</span>]                    <span class="co"># PCs needed (std) for 95%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> <span class="fu">c</span>(<span class="st">&quot;raw&quot;</span>, <span class="st">&quot;standardized&quot;</span>),                           <span class="co"># scale type</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcs_needed_for_95pct =</span> <span class="fu">c</span>(k_raw, k_std),                     <span class="co"># count of PCs to reach 95%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">cumulative_variance =</span> <span class="fu">c</span>(<span class="fu">cumsum</span>(pve_raw)[k_raw], <span class="fu">cumsum</span>(pve_std)[k_std])  <span class="co"># achieved cum PVE</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>)                                                           <span class="co"># show summary</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["scale"],"name":[1],"type":["chr"],"align":["left"]},{"label":["pcs_needed_for_95pct"],"name":[2],"type":["int"],"align":["right"]},{"label":["cumulative_variance"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"raw","2":"2","3":"0.9994522"},{"1":"standardized","2":"5","3":"0.9724443"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Interpretation: - Raw-scale PCA reaches ≥95% variance with 2 components; standardized PCA does so with 5. Because variables are on different units (ns vs KB vs counts vs performance), the standardized solution is the safer, more interpretable default. - The first standardized PC loads heavily (in magnitude) on memory and performance (<code>MMAX</code>, <code>MMIN</code>, <code>PRP</code>, <code>ERP</code>, plus <code>CACH</code>), so it summarizes overall “capacity/performance.” PC2 contrasts channel capacity (<code>CHMAX</code>) against cycle time and minimum channels, hinting at an I/O vs speed axis. - In other words, most of the multivariate variability can be compressed into the first few standardized components: with only 5 PCs we already achieve at least 95% of the total variance, which is a substantial reduction from the original 8 dimensions. - Recommendation: for dimension reduction we report the standardized PCA and retain the first 5 components (≥95% variance), interpreting PC1 as a scale of overall performance/memory and PC2 as a channels vs speed dimension; the remaining retained PCs mostly capture finer contrasts between already powerful machines.</p>
</section>
<section id="loadings-and-interpretation-aids" class="level2" data-number="6.2">
<h2 data-number="6.2"><span class="header-section-number">6.2</span> Loadings and interpretation aids</h2>
<p>Inspect which variables drive the first PCs (signs may flip without changing interpretation).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pca_raw<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">3</span>, <span class="fu">ncol</span>(num_vars))])  <span class="co"># raw loadings (first PCs)</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                PC1           PC2           PC3
MYCT   0.0141412358 -0.0077399303  0.9994839149
MMIN  -0.2286221980  0.9731769922  0.0106566935
MMAX  -0.9733452865 -0.2289360796  0.0119681990
CACH  -0.0012202199  0.0012445172  0.0001322595
CHMIN -0.0001606719  0.0006590092 -0.0020541284
CHMAX -0.0007701548 -0.0025019794 -0.0219924018</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pca_std<span class="sc">$</span>rotation[, <span class="dv">1</span><span class="sc">:</span><span class="fu">min</span>(<span class="dv">3</span>, <span class="fu">ncol</span>(num_vars))])  <span class="co"># standardized loadings (first PCs)</span></span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             PC1         PC2         PC3
MYCT   0.2609775 -0.39938737 -0.72811374
MMIN  -0.3860768 -0.28892323  0.06954451
MMAX  -0.3871015  0.16725096 -0.28349782
CACH  -0.3699990  0.01382335 -0.32360056
CHMIN -0.3328552 -0.25326137  0.45179763
CHMAX -0.1386368  0.79963560 -0.15685676</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>top_loadings <span class="ot">&lt;-</span> <span class="cf">function</span>(rot, <span class="at">pcs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">k =</span> <span class="dv">3</span>) {              <span class="co"># helper to grab top loadings</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(pcs, <span class="cf">function</span>(j) {          <span class="co"># loop over PCs of interest</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    ord <span class="ot">&lt;-</span> <span class="fu">order</span>(<span class="fu">abs</span>(rot[, j]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="fu">seq_len</span>(k)]  <span class="co"># top k by abs loading</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">PC =</span> <span class="fu">paste0</span>(<span class="st">&quot;PC&quot;</span>, j),                          <span class="co"># which PC</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">variable =</span> <span class="fu">rownames</span>(rot)[ord],                 <span class="co"># variable name</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">loading =</span> <span class="fu">round</span>(rot[ord, j], <span class="dv">3</span>),               <span class="co"># signed loading</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">abs_loading =</span> <span class="fu">round</span>(<span class="fu">abs</span>(rot[ord, j]), <span class="dv">3</span>)       <span class="co"># absolute loading</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>top_std <span class="ot">&lt;-</span> <span class="fu">top_loadings</span>(pca_std<span class="sc">$</span>rotation, <span class="at">pcs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">k =</span> <span class="dv">4</span>)   <span class="co"># top 4 for std PCs 1-2</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>top_raw <span class="ot">&lt;-</span> <span class="fu">top_loadings</span>(pca_raw<span class="sc">$</span>rotation, <span class="at">pcs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">k =</span> <span class="dv">4</span>)   <span class="co"># top 4 for raw PCs 1-2</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(                                                          <span class="co"># bundle for printing</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_loadings_standardized =</span> top_std,                        <span class="co"># report std top loadings</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">top_loadings_raw =</span> top_raw                                  <span class="co"># report raw top loadings</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$top_loadings_standardized
       PC variable loading abs_loading
PRP   PC1      PRP  -0.429       0.429
ERP   PC1      ERP  -0.427       0.427
MMAX  PC1     MMAX  -0.387       0.387
MMIN  PC1     MMIN  -0.386       0.386
CHMAX PC2    CHMAX   0.800       0.800
MYCT  PC2     MYCT  -0.399       0.399
MMIN1 PC2     MMIN  -0.289       0.289
CHMIN PC2    CHMIN  -0.253       0.253

$top_loadings_raw
       PC variable loading abs_loading
MMAX  PC1     MMAX  -0.973       0.973
MMIN  PC1     MMIN  -0.229       0.229
MYCT  PC1     MYCT   0.014       0.014
PRP   PC1      PRP  -0.009       0.009
MMIN1 PC2     MMIN   0.973       0.973
MMAX1 PC2     MMAX  -0.229       0.229
PRP1  PC2      PRP   0.019       0.019
ERP   PC2      ERP   0.010       0.010</code></pre>
</div>
</div>
</section>
<section id="scores-plot-first-two-pcs" class="level2" data-number="6.3">
<h2 data-number="6.3"><span class="header-section-number">6.3</span> Scores plot (first two PCs)</h2>
<p>Use labels to spot grouping and extremes; standardized version is shown here.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>scores_std <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca_std<span class="sc">$</span>x)                    <span class="co"># PCA scores (std)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>scores_std<span class="sc">$</span>machine <span class="ot">&lt;-</span> machines_sub<span class="sc">$</span>machine               <span class="co"># add machine names</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(scores_std<span class="sc">$</span>PC1, scores_std<span class="sc">$</span>PC2, <span class="at">pch =</span> <span class="dv">19</span>,           <span class="co"># scatter of PC1 vs PC2</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;PC1 (std)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2 (std)&quot;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scores on standardized data&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(scores_std<span class="sc">$</span>PC1, scores_std<span class="sc">$</span>PC2, <span class="at">labels =</span> scores_std<span class="sc">$</span>machine,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.6</span>)                                 <span class="co"># label points</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: the standardized score plot shows where machines align along the performance/memory axis (PC1) and the channels-vs-speed axis (PC2). Machines far to the right on PC1 have higher memory and performance ratings, whereas the vertical spread reflects different channel configurations relative to cycle time. Labels make it easy to relate extreme scores back to specific models when discussing results.</p>
</section>
</section>
<section id="outlier-experiment" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Outlier experiment</h1>
<p>Introduce the atypical point at the former <code>hp-3000/64</code> row (no standardization).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>xnew <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">75</span>, <span class="dv">2000</span>, <span class="fl">0.8</span>, <span class="dv">80000</span>, <span class="dv">300</span>, <span class="dv">24</span>, <span class="dv">62</span>, <span class="dv">47</span>)          <span class="co"># injected outlier values</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>machines_out <span class="ot">&lt;-</span> machines_sub                              <span class="co"># start from subset</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>machines_out[machines_out<span class="sc">$</span>machine <span class="sc">==</span> <span class="st">&quot;hp-3000/64&quot;</span>, <span class="fu">names</span>(num_vars)] <span class="ot">&lt;-</span> xnew  <span class="co"># replace row</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>pca_out_classic <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(machines_out[<span class="fu">names</span>(num_vars)], <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale. =</span> <span class="cn">FALSE</span>)   <span class="co"># classic PCA with outlier</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>pca_out_robust <span class="ot">&lt;-</span> <span class="fu">PcaCov</span>(machines_out[<span class="fu">names</span>(num_vars)], <span class="at">cov.control =</span> <span class="fu">CovControlMcd</span>(), <span class="at">scale =</span> <span class="cn">FALSE</span>)  <span class="co"># robust PCA</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>pve_out_classic <span class="ot">&lt;-</span> pca_out_classic<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(pca_out_classic<span class="sc">$</span>sdev<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># PVE classic</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>pve_out_robust <span class="ot">&lt;-</span> pca_out_robust<span class="sc">@</span>eigenvalues <span class="sc">/</span> <span class="fu">sum</span>(pca_out_robust<span class="sc">@</span>eigenvalues)  <span class="co"># PVE robust</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">component =</span> <span class="fu">seq_along</span>(pve_out_classic),                 <span class="co"># component index</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">classic_pct =</span> <span class="fu">round</span>(pve_out_classic <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),          <span class="co"># classic PVE (%)</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">robust_pct =</span> <span class="fu">round</span>(pve_out_robust <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>)             <span class="co"># robust PVE (%)</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source type="application/json">
{"columns":[{"label":["component"],"name":[1],"type":["int"],"align":["right"]},{"label":["classic_pct"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["robust_pct"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"57.96","3":"89.76"},{"1":"2","2":"39.58","3":"7.87"},{"1":"3","2":"2.44","3":"2.36"},{"1":"4","2":"0.02","3":"0.00"},{"1":"5","2":"0.00","3":"0.00"},{"1":"6","2":"0.00","3":"0.00"},{"1":"7","2":"0.00","3":"0.00"},{"1":"8","2":"0.00","3":"0.00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>This table allows us to compare how the injected outlier redistributes the variance across components under the classical and robust approaches. In the classical PCA, the first eigenvalue typically inflates and captures a very large share of the variance because the outlier dominates the covariance structure. In contrast, the robust eigenvalues stay closer to what we observed without the outlier, meaning that the bulk geometry is preserved.</p>
<section id="visual-comparison-scores" class="level2" data-number="7.1">
<h2 data-number="7.1"><span class="header-section-number">7.1</span> Visual comparison: scores</h2>
<p>Outlier effect: in classical PCA, the first axis often aligns with the extreme point; robust PCA should stay closer to the bulk structure.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))                                       <span class="co"># two plots</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_classic<span class="sc">$</span>x[,<span class="dv">1</span>], pca_out_classic<span class="sc">$</span>x[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Classic PCA with outlier&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span>)  <span class="co"># classic scores</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca_out_classic<span class="sc">$</span>x[,<span class="dv">1</span>], pca_out_classic<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> machines_out<span class="sc">$</span>machine, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)              <span class="co"># labels</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_robust<span class="sc">@</span>scores[,<span class="dv">1</span>], pca_out_robust<span class="sc">@</span>scores[,<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Robust PCA (MCD)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;PC1&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PC2&quot;</span>)          <span class="co"># robust scores</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(pca_out_robust<span class="sc">@</span>scores[,<span class="dv">1</span>], pca_out_robust<span class="sc">@</span>scores[,<span class="dv">2</span>],</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> machines_out<span class="sc">$</span>machine, <span class="at">pos =</span> <span class="dv">3</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)              <span class="co"># labels</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))                                       <span class="co"># reset layout</span></span></code></pre></div>
</details>
</div>
<section id="distance-diagnostics-robust-pca" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1"><span class="header-section-number">7.1.1</span> Distance diagnostics (robust PCA)</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pca_out_robust)  <span class="co"># outlier map: orthogonal vs score distances</span></span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img src="report_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="decisions" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Decisions</h1>
<ul>
<li>For exploratory analysis we rely on classical summaries to describe central tendency and spread, but interpret them in parallel with robust statistics (trimmed and winsorized means, MAD and MCD-based Mahalanobis distances) to avoid being misled by a few extreme machines.</li>
<li>For dimension reduction we base our decision on the proportion of variance explained and interpretability of the loadings: we favour the standardized PCA and retain the first 5 principal components, which already explain at least 95% of the total variance in the eight numeric variables.</li>
<li>When a single atypical observation is present, we use robust PCA based on the MCD covariance estimate to describe the multivariate structure of the bulk of the data, and treat the classical PCA mainly as a diagnostic to illustrate the effect of the outlier.</li>
</ul>
</section>
<section id="conclusions" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Conclusions</h1>
<p>The subset of <code>machines</code> data considered here exhibits a clear gradient from low to high capability systems, mainly driven by memory size, cache and performance measures. The preliminary analysis using classical and robust summaries, together with Mahalanobis distances, shows that most machines cluster around a central configuration while a small number of high-end models stand out as multivariate outliers.</p>
<p>Standardized PCA provides an effective summary of this structure: with only 5 components we retain at least 95% of the total variance and obtain interpretable directions, where the first component captures an overall performance/memory level and the second contrasts channel capacity with speed. Plotting the scores on these components reveals how specific named machines occupy different regions of the performance–channels trade-off.</p>
<p>After injecting the artificial outlier, classical PCA becomes strongly influenced by this single observation, reallocating a large share of variance to the first component and distorting the geometry of the remaining points. In contrast, the MCD-based robust PCA keeps the eigenvalues and loading patterns closer to the original analysis and clearly isolates the modified machine in the outlier map. This comparison illustrates the vulnerability of classical PCA to even one atypical observation and motivates the use of robust methods when data contamination is plausible.</p>
</section>
<section id="bibliography" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Bibliography</h1>
<ul>
<li>Jolliffe, I. T. (2002). <em>Principal Component Analysis</em>. Springer.</li>
<li>Todorov, V., &amp; Filzmoser, P. (2009). An object oriented framework for robust multivariate analysis. <em>Journal of Statistical Software</em>, 32(3), 1–47. ***</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id = "quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->

</body>

</html>
